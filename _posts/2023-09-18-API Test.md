---
layout: post
---

<table id="dataTable">
  <thead>
    <tr>
      <th colspan="3">CodeLove-站長阿川-最新文章</th>
    </tr>
  </thead>
  <tbody>
  <tr>
    <td>日期</td>
    <td>標題</td>
    <td>連結</td>
  </tr>
  </tbody>
</table>

<input type="button" id="btnMore" value="Read more...">

<script>
  let apiURL = "https://codelove.tw/api/posts?username=howtomakeaturn&per_page=5&page=";
  let apiTable = document.getElementById("dataTable");
  let pageCount = 1;

  let btn = document.getElementById("btnMore");
  
  callAPI(apiURL + pageCount, apiTable);
  pageCount += 1;
  
  btn.onclick = function () {
      callAPI(apiURL + pageCount, apiTable);
      pageCount += 1;
  };
  
  function callAPI(url, table){
    fetch(url)
      .then((res) => {
        const data = res.json();
        return data;
      })
      .then((data) => {
        console.log(data);
        if(data.length == 0){
          alert('沒有更多文章了!');          
          return;
        }
        for (let i = 0; i < data.length; i++) {
          let dr = document.createElement("TR");
    
          let dc_date = document.createElement("TD");
          let postDate = new Date(temp1[0]['published_at']);
          let year = postDate.getFullYear();
          let month = postDate.getMonth();
          let day = postDate.getDate();
          let formatDate = `${year}-${month}-${day}`;
          let txt = document.createTextNode(formatDate);
          dc_date.appendChild(txt);
          dc_date.style.width = '20%';
          dr.appendChild(dc_date);
          
          let dc_title = document.createElement("TD");
          txt = document.createTextNode(data[i]['title']);
          dc_title.appendChild(txt);
          dr.appendChild(dc_title);
    
          let dc_url = document.createElement("TD");
          let url = document.createElement("a");
          url.href = data[i]['canonical_url'];
          url.innerHTML = data[i]['id'];
          url.target="_blank";
          dc_url.appendChild(url);
          dr.appendChild(dc_url);
          
          table.appendChild(dr);
        }
      });
  }
</script>
